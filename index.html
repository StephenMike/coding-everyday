<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    
     window.onerror = function (msg, url, row, col, error) {
       console.log(msg, url,  row, col, error)
  console.log('我知道错误了');
  // return true; // 返回 true 的时候，异常不会向上抛出，控制台不会输出错误
};

const a = 'adf'
    a  = 123
window.addEventListener(
  "error",
  e => {
    e.stopImmediatePropagation();
    const srcElement = e.srcElement;
    if (srcElement === window) {
      // 全局错误
      console.log("全局错误");
      console.log("message", e.message);
    } else {
      // 元素错误，比如引用资源报错
      console.log("元素错误");
      console.log("tagname", srcElement.tagName);
      console.log("src", srcElement.src);
    }
    console.log("onerror捕获网络请求错误", e); // 捕获错误
  },
  true //网络错误，在捕获阶段获取，第三个参数为true
);
  </script>
  <script src="//baidu.com/test.js"></script>
  <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
  <img src="//baidu.com/test.js" alt="图片加载中" /> 
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <img src="https://avatars0.githubusercontent.com/u/41728540?s=60&v=4" alt="图片加载中" />
  <script>
  //   var imgObj = document.getElementById("img");
  // imgObj.onerror = function(e) {
  //   console.log("obj.onerror捕获网络请求错误", e); // 捕获错误
  //   console.log("tagname", e.srcElement.tagName);
  //   console.log("src", e.srcElement.src);
  // };

  (function() {
  // 浏览器不支持，就算了！
  if (!window.performance && !window.performance.getEntries) {
    return false;
  }

  var result = [];
  // 获取当前页面所有请求对应的PerformanceResourceTiming对象进行分析
  window.performance.getEntries().forEach(item => {
    result.push({
      url: item.name,
      entryType: item.entryType,
      type: item.initiatorType,
      "duration(ms)": item.duration
    });
  });

  // 控制台输出统计结果
  console.table(result);
})();
  </script>
</body>
</html>